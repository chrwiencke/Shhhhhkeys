<%- include('../partials/header'); -%>
<%- include('../partials/navbardashboard'); -%>

<div class="container mt-4">
    <h1>Add Level</h1>
    <% if (!user.teacher) { %>
        <p>Access denied. Teachers only.</p>
    <% } else { %>
        <form action="/dashboard/create-level" method="POST">
            <div class="form-group mb-3">
                <label for="username">Student Username:</label>
                <input type="text" class="form-control" id="username" name="username" required>
            </div>
            <div class="form-group mb-3">
                <label for="levelNumber">Level Number:</label>
                <input type="number" class="form-control" id="levelNumber" name="levelNumber" required min="1">
            </div>
            
            <div id="milestones">
                <div class="milestone-entry border p-3 mb-3">
                    <h4>Milestone 1</h4>
                    <div class="form-group mb-2">
                        <label>Description:</label>
                        <input type="text" class="form-control" name="milestones[0][description]" required>
                    </div>
                    <div class="form-group">
                        <label>Grade (0-3):</label>
                        <input type="number" class="form-control" name="milestones[0][grade]" required min="0" max="3">
                    </div>
                </div>
            </div>
            
            <button type="button" class="btn btn-secondary mb-3" onclick="addMilestone()">Add Another Milestone</button>
            <button type="submit" class="btn btn-primary d-block">Submit Level</button>
        </form>

        <script>
            let milestoneCount = 1;
            
            function addMilestone() {
                const milestonesDiv = document.getElementById('milestones');
                const newMilestone = document.createElement('div');
                newMilestone.className = 'milestone-entry border p-3 mb-3';
                
                newMilestone.innerHTML = `
                    <h4>Milestone ${milestoneCount + 1}</h4>
                    <div class="form-group mb-2">
                        <label>Description:</label>
                        <input type="text" class="form-control" name="milestones[${milestoneCount}][description]" required>
                    </div>
                    <div class="form-group">
                        <label>Grade (0-3):</label>
                        <input type="number" class="form-control" name="milestones[${milestoneCount}][grade]" required min="0" max="3">
                    </div>
                `;
                
                milestonesDiv.appendChild(newMilestone);
                milestoneCount++;
            }
        </script>
    <% } %>
</div>

<%- include('../partials/footer'); -%>